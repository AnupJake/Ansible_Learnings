---
# Ansible playbook to create a new db server and install mysql server and client into the server.
- name: DB server creation and Server Hardening in nginxdb
  hosts: nginxdb
  become: yes
  tasks:
      - name: Patching to ensure that the latest version of all packages.
        package:
          name: '*'
          state: latest

      - name: Installation of MySQL in the nginxdb server.
        action: apt pkg={{item}} state=latest
        with_items:
          - mysql-server
          - mysql-client
          - python3-mysqldb

      - name: Start the MySQL service in nginxdb server.
        service:
          name: mysql
          state: started
          enabled: yes

      - name: Create credentials for user for mysql in the nginxdb server.
        mysql_user: user="anup_ukg" host="%" password="1234" priv=*.*:ALL,GRANT
